using flistscraping;
using HtmlAgilityPack;

var htmlSource = @"<html lang=""en""><head></head><body>
<div class=""results""><h4>Results</h4><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/ato shiako.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Ato Shiako</span><span text=""""><span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/bombshell bounty.png""><span class=""user-view gender-shemale""><span class=""fa-fw fa fa-eye""></span>Bombshell Bounty</span><span text=""On for a bit of chitchat right now!  So! Lowkey...Kass from Breath of the Wild is a seriously [sup]HOT[/sup] bird...I'd fuck him into a crater level hot...
[eicon]BBsmirk1[/eicon][eicon]BBsmirk2[/eicon]
[eicon]BBsmirk3[/eicon][eicon]BBsmirk4[/eicon]""><span class=""bbcode"">On for a bit of chitchat right now!  So! Lowkey...Kass from Breath of the Wild is a seriously <sup>HOT</sup> bird...I'd fuck him into a crater level hot...
<img src=""https://static.f-list.net/images/eicon/bbsmirk1.gif"" alt=""BBsmirk1"" title=""BBsmirk1"" class=""character-avatar icon""><img src=""https://static.f-list.net/images/eicon/bbsmirk2.gif"" alt=""BBsmirk2"" title=""BBsmirk2"" class=""character-avatar icon"">
<img src=""https://static.f-list.net/images/eicon/bbsmirk3.gif"" alt=""BBsmirk3"" title=""BBsmirk3"" class=""character-avatar icon""><img src=""https://static.f-list.net/images/eicon/bbsmirk4.gif"" alt=""BBsmirk4"" title=""BBsmirk4"" class=""character-avatar icon""></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/bounty hunter zane.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Bounty Hunter Zane</span><span text=""[b]Already wrangled and bred ten bitchboys today and it's not even noon yet. I've got plenty of stamina and Wusky juice to go around, so who's next? Don't be shy, I won't hurt you... [color=red]much.[/color][/b]""><span class=""bbcode""><strong>Already wrangled and bred ten bitchboys today and it's not even noon yet. I've got plenty of stamina and Wusky juice to go around, so who's next? Don't be shy, I won't hurt you... <span class=""redText"">much.</span></strong></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/commander sakura.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Commander Sakura</span><span text=""[url=https://static.f-list.net/images/charinline/6f/04/6f04e6808a3b8b2be6399c2b757c64024a7a3c72.jpg]Keep your monsters on a short leash~[/url]""><span class=""bbcode""><span><i class=""fa fa-link""></i><a href=""https://static.f-list.net/images/charinline/6f/04/6f04e6808a3b8b2be6399c2b757c64024a7a3c72.jpg"" rel=""nofollow noreferrer noopener"" target=""_blank"" class=""user-link"" title=""https://static.f-list.net/images/charinline/6f/04/6f04e6808a3b8b2be6399c2b757c64024a7a3c72.jpg"">Keep your monsters on a short leash~</a><span class=""link-domain bbcode-pseudo""> [static.f-list.net]</span></span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/eldrik.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Eldrik</span><span text=""""><span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/greedy fox-spirit.png""><span class=""user-view gender-herm""><span class=""fa-fw fa fa-eye""></span>Greedy Fox-spirit</span><span text=""""><span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/jimmy coleman.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Jimmy Coleman</span><span text=""""><span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/kalamew kuzi.png""><span class=""user-view gender-female""><span class=""fa-fw fa fa-eye""></span>Kalamew Kuzi</span><span text=""[b][color=purple]Who would like to Play with this pussy? She loves to have a nice pair of lips on her or a big dick inside.  Or are you going to try to take her home with you?[/color][/b]""><span class=""bbcode""><strong><span class=""purpleText"">Who would like to Play with this pussy? She loves to have a nice pair of lips on her or a big dick inside.  Or are you going to try to take her home with you?</span></strong></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/kathie f.png""><span class=""user-view gender-female""><span class=""fa-fw fa fa-eye""></span>Kathie F</span><span text=""(Should i make an ad on Channels?)""><span class=""bbcode"">(Should i make an ad on Channels?)</span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/mega smoothie.png""><span class=""user-view gender-herm""><span class=""fa-fw fa fa-eye""></span>MEGA Smoothie</span><span text=""Hunting for some fun today~

Should I be a Space Marine or a Rogue Trader?""><span class=""bbcode"">Hunting for some fun today~

Should I be a Space Marine or a Rogue Trader?</span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/mothy the moth.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Mothy The Moth</span><span text=""Moth boy at your service! Well unless you'd rather be at his~
Come ask the moth some [url=https://tellonym.me/mothythemoth]questions![/url]""><span class=""bbcode"">Moth boy at your service! Well unless you'd rather be at his~
Come ask the moth some <span><i class=""fa fa-link""></i><a href=""https://tellonym.me/mothythemoth"" rel=""nofollow noreferrer noopener"" target=""_blank"" class=""user-link"" title=""https://tellonym.me/mothythemoth"">questions!</a><span class=""link-domain bbcode-pseudo""> [tellonym.me]</span></span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/pocus.png""><span class=""user-view gender-female""><span class=""fa-fw fa fa-eye""></span>Pocus</span><span text=""A tall and [url=https://tinyurl.com/2c3tehp8]busty[/url] majin is looking for some raunchy entertainment, Vore is optional but would be absolutely loved. [url=https://tinyurl.com/2p8uhjnd]Feeling[/url] [url=https://tinyurl.com/2n3ccj2h]famished.~[/url]""><span class=""bbcode"">A tall and <span><i class=""fa fa-link""></i><a href=""https://tinyurl.com/2c3tehp8"" rel=""nofollow noreferrer noopener"" target=""_blank"" class=""user-link"" title=""https://tinyurl.com/2c3tehp8"">busty</a><span class=""link-domain bbcode-pseudo""> [tinyurl.com]</span></span> majin is looking for some raunchy entertainment, Vore is optional but would be absolutely loved. <span><i class=""fa fa-link""></i><a href=""https://tinyurl.com/2p8uhjnd"" rel=""nofollow noreferrer noopener"" target=""_blank"" class=""user-link"" title=""https://tinyurl.com/2p8uhjnd"">Feeling</a><span class=""link-domain bbcode-pseudo""> [tinyurl.com]</span></span> <span><i class=""fa fa-link""></i><a href=""https://tinyurl.com/2n3ccj2h"" rel=""nofollow noreferrer noopener"" target=""_blank"" class=""user-link"" title=""https://tinyurl.com/2n3ccj2h"">famished.~</a><span class=""link-domain bbcode-pseudo""> [tinyurl.com]</span></span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/ryu sunderland.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Ryu Sunderland</span><span text=""Big, brutish kinda mood. Growth, TF, etc.""><span class=""bbcode"">Big, brutish kinda mood. Growth, TF, etc.</span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/savannah rose.png""><span class=""user-view gender-male""><span class=""fa-fw fa fa-eye""></span>Savannah Rose</span><span text=""C'est la vie.""><span class=""bbcode"">C'est la vie.</span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/shavra.png""><span class=""user-view gender-herm""><span class=""fa-fw fa fa-eye""></span>Shavra</span><span text=""Canon characters!""><span class=""bbcode"">Canon characters!</span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/sweet majesty.png""><span class=""user-view gender-female""><span class=""fa-fw fa fa-eye""></span>Sweet Majesty</span><span text=""[url=https://static.f-list.net/images/charinline/95/a5/95a55fa8827c3e9f073a5d934cf0e198b00a1001.png]You dumb monkeys really enjoy nipples, don't you?[/url]""><span class=""bbcode""><span><i class=""fa fa-link""></i><a href=""https://static.f-list.net/images/charinline/95/a5/95a55fa8827c3e9f073a5d934cf0e198b00a1001.png"" rel=""nofollow noreferrer noopener"" target=""_blank"" class=""user-link"" title=""https://static.f-list.net/images/charinline/95/a5/95a55fa8827c3e9f073a5d934cf0e198b00a1001.png"">You dumb monkeys really enjoy nipples, don't you?</a><span class=""link-domain bbcode-pseudo""> [static.f-list.net]</span></span></span></span></div><div class=""status-looking""><img src=""https://static.f-list.net/images/avatar/the bomb queen.png""><span class=""user-view gender-shemale""><span class=""fa-fw fa fa-eye""></span>The Bomb Queen</span><span text=""""><span></span></span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Ace Kenshader</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Alex Faztrix</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Amy Deathblossom</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Apex-Gura</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Arawinla</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Archy Eiser</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Aria of Silence</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span><span class=""far fa-gem""></span>Artificial Giantess</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Athinia</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Bottom Heavy Frisk</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Chaz Winters</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Chrysophylax-III</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Craig</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Crystal_</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Demon Queen Mei</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Demonstrably Demonic</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Denser Than Metal</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Dominant Gnome</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Dragoness Lisa</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Emily Maple</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Empress Deprava</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Empress Shiro</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Felix Ortiz</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Flash McCloud</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Fyrelle</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Fyrelola</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Glaistig Gorm</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>GlooMeGlo</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Guti</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Hasegawa Goro</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Hati</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Heat Press</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Holly Blight</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Hyper Femboy</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Igneous Black</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Jack Maraja</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Jake Pump</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Jamie Benett</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Jessica Volt</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Jogger Horse</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Juliet A</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Jund Skinchanger</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Kay Bellona</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Lasra Nightshade</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Leucien Weaver</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>LigerCat-Hercules</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Littos</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Lord Bazrakar</span></div><div class=""status-offline""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Maya the Mew</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Mrs Nightgaze</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Nate Johnson</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Novak Vhuulezau</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Oberon of Avalon</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Obrove</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>One Big Bad Wolf</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>One More Goodra</span></div><div class=""status-online""><span class=""user-view gender-shemale""><span class=""fa-fw far fa-user""></span>Perfect Mika</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Programmer Femboy</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Ralf the large Horse</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Rezi_Voire</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Roo</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Rubri</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Saldryn Dalamiq</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Samuelle Erie</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Sara Narakome</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Sera Alysses</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Shinvai</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Supreme Asari</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>The Quagmire Forest</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Thomas Dupelage</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Titanhoss</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Troublegum</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>Uchiha Legacy</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Valeria Anima</span></div><div class=""status-online""><span class=""user-view gender-female""><span class=""fa-fw far fa-user""></span>Vari-</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>Zielis</span></div><div class=""status-online""><span class=""user-view gender-male""><span class=""fa-fw far fa-user""></span>d0vah the dragon</span></div><div class=""status-online""><span class=""user-view gender-herm""><span class=""fa-fw far fa-user""></span>vikraal</span></div></div>
</body></html>";
// Scrape the character URLs from the HTML source
var characterUrls = ScrapeCharacterUrls(htmlSource);

// Create a list to store the CharacterInfo objects
var characters = new List<CharacterInfo>();

// Loop through each character URL and scrape its information
foreach (var url in characterUrls)
{
    var characterInfo = new CharacterInfo();
    characterInfo.SetUrl(url);
    try
    {
        var profileScraping = new ProfileScraping(url, characterInfo);
        profileScraping.ScrapeCharacterInfoSideBar();
        profileScraping.ScrapeCharacterRpInfo();
        profileScraping.ScrapeCharacterKink();
    } catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
    }
    characters.Add(characterInfo);
}

// Output the scraped character information to the console
var characterList = new CharacterList(characters);
characterList.ExportToExcel(@"C:\Users\aryus\source\repos\test.xlsx");

static List<string> ScrapeCharacterUrls(string htmlSource)
{
    var characterUrls = new List<string>();

    var doc = new HtmlDocument();
    doc.LoadHtml(htmlSource);

    var userViews = doc.DocumentNode.SelectNodes("//span[contains(@class, 'user-view')]");
    if (userViews != null)
    {
        foreach (var userView in userViews)
        {
            var characterName = userView.InnerText;
            characterName = characterName.Replace(" ", "%20");
            var characterUrl = $"https://www.f-list.net/c/{characterName}";
            characterUrls.Add(characterUrl);
        }
    }

    return characterUrls;
}
